---
title: "P8105_HW2_HL2710"
author: "Ainsel Levitskaia-Collins, HL2710"
date: "2025-09-25"
output: github_document
---

```{r include = FALSE}
library(tidyverse)
```


### Problem 1

Importing and cleaning `pols_month`:

- Breaking `mon` into year/month/day variables
- Replacing month number with month name
- Combining `prez_dem` and `prez_gop` into a single variable
- Removing the`day` variable
- Ensure that the `year` variable will match with the `snp` dataset

```{r message = FALSE}
pols_month <-
  read_csv("./data/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "mon"), sep = 4) %>% 
  separate(mon, into = c("month", "day"), sep = 4) %>% 
  mutate(
    month = case_match(month,
      "-01-" ~ "January",
      "-02-" ~ "February",
      "-03-" ~ "March",
      "-04-" ~ "April",
      "-05-" ~ "May",
      "-06-" ~ "June",
      "-07-" ~ "July",
      "-08-" ~ "August",
      "-09-" ~ "September",
      "-10-" ~ "October",
      "-11-" ~ "November",
      "-12-" ~ "December")) %>% 
  pivot_longer(
    starts_with("prez_"), 
    names_to = "president", 
    names_prefix = "prez_", 
    values_to = "president_yn") %>% 
  separate(year, into = c("extra", "year"), sep = 2) %>% 
  select(-day, -extra)

pols_month
```

Importing and cleaning `snp`:

- Breaking `date` into year/month/day variables
- Ensuring that `year` and `month` are the leading columns
- Removing the `day` variable
- Replacing month number with month name

```{r message = FALSE}
snp <-
  read_csv("./data/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate_wider_delim(
    date,
    delim = "/",
    names_sep = ".") %>% 
  select(
    year = date.3,
    month = date.1,
    everything()
  ) %>% 
  select(-date.2) %>% 
  mutate(
    month = case_match(month,
      "1" ~ "January",
      "2" ~ "February",
      "3" ~ "March",
      "4" ~ "April",
      "5" ~ "May",
      "6" ~ "June",
      "7" ~ "July",
      "8" ~ "August",
      "9" ~ "September",
      "10" ~ "October",
      "11" ~ "November",
      "12" ~ "December"))

snp
```

Importing and cleaning `unemployment`:

- Switching from "wide" to "long" format
- Ensuring all variables have the appropriate name
- Ensuring that all variables take the same values
- Ensure that the `year` variable will match with the `snp` dataset

```{r message = FALSE}
unemployment <-
  read_csv("./data/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "prcnt_unemployment"
  ) %>% 
  mutate(
    month = case_match(month,
      "jan" ~ "January",
      "feb" ~ "February",
      "mar" ~ "March",
      "apr" ~ "April",
      "may" ~ "May",
      "jun" ~ "June",
      "jul" ~ "July",
      "aug" ~ "August",
      "sep" ~ "September",
      "oct" ~ "October",
      "nov" ~ "November",
      "dec" ~ "December")) %>% 
  separate(year, into = c("extra", "year"), sep = 2) %>% 
  select(-extra)

unemployment
```

Joining datasets:

1. Merge `snp` into `pols`
1. Merge `unemployment` into the result

```{r}
pols_snp_unemployment <- left_join(pols_month, snp, by = c("year", "month")) %>% 
  left_join(unemployment, by = c("year", "month"))

pols_snp_unemployment
```

The `pols_month` dataset has 1644 observations and 10 variables, and it contains information 
on the number of republican and democratic governors, senators, and representatives, and whether 
the president is democratic and republican, for each observed date. The `snp` dataset has 787 
observations and 3 variables, and it contains information on the closing value of the S&P stock 
index for each observed date. The `unemployment` dataset has 816 observations and 3 variables, and it 
contains information on the percentage of unemployment for each observed date. 

The final dataset resulting 
from a merge between the three, `pols_snp_unemployment`, has 1644 observations and 12 variables, and it 
contains the percentage of unemployment, S&P closing stock index value, and number of politicians per 
political party for each observed date.

### Problem 2

Importing and cleaning `Mr. Trash Wheel`:

1. Omit non-data entries
1. Ensure variable names are reasonable
1. Omit rows without dumpster-specific data
1. Round the number of sports balls to the nearest integer and convert the result to an integer variable
1. Add indicator for trash type and sort variables accordingly
1. Add a prefix to non-ID variables for later dataframe combining purposes

```{r message = FALSE}
mr_trash <-
  readxl::read_excel("./data/202409 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", skip = 1) %>% 
  janitor::clean_names() %>% 
  select(-x15, -x16) %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(sports_balls, 0),
    sports_balls = as.integer(sports_balls),
    trash_type = "mister",
    year = as.numeric(year)
  ) %>% 
  select(dumpster, trash_type, everything())

mr_trash
```

Repeating the same process for `Professor Trash Wheel` and `Gwynnda Trash Wheel`:

```{r}
prof_trash <-
  readxl::read_excel("./data/202409 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(trash_type = "professor") %>% 
  select(dumpster, trash_type, everything())

prof_trash
```

```{r}
gwynnda_trash <-
  readxl::read_excel("./data/202409 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(trash_type = "gwynnda") %>% 
  select(dumpster, trash_type, everything())

gwynnda_trash
```

Combining all three trash datasets to produce a single trash dataset using inline R:

```{r}
trash <- bind_rows(mr_trash, prof_trash, gwynnda_trash)

x <- filter(trash, 
            trash_type == "professor")
sum(
  pull(x, weight_tons), 
  na.rm = TRUE)

x <- filter(trash, 
            trash_type == "gwynnda", 
            month == "June", 
            year == 2022)
sum(
  pull(x, cigarette_butts), 
  na.rm = TRUE)
```

In the final`trash` dataset, there are 1033 observations of 15 variables. This data contains 
the trash collection statistics for the Mister Trash Wheel, the Professor Trash Wheel, and the 
Gwynnda Trash Wheel. As examples of the data included:

- The total weight of trash collected by Professor Trash Wheel is 
- The total number of cigarette butts collected by Gwynnda Trash Wheel in June of 2022 is 

### Problem 3

